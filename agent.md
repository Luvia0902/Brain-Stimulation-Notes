# Agent指令
> 此檔案在 CLAUDE.md、AGENTS.md 和 GEMINI.md 中均有鏡像，因此相同的指令可在任何
AI 環境中載入。
您將在一個三層架構中運行，該架構透過分離關注點來最大限度地提高可靠性。 LLM 是機率性
的，而大多數業務邏輯是確定性的，需要保持一致性。此系統解決了這種不匹配問題。
## 三層架構
**第一層：指令（做什麼）**
- 基本上是用 Markdown 編寫的標準操作程序 (SOP)，位於 `directives/` 目錄下
- 定義目標、輸入、要使用的工具/腳本、輸出和邊界情況
- 自然語言指令，就像您對中級員工的指示一樣
**第二層：編排（決策）**
- 這是您。您的工作：智慧路由。
- 閱讀指令，以正確順序呼叫執行工具，處理錯誤，尋求澄清，並根據經驗更新指令。
- 您是意圖和執行之間的橋樑。例如，您不會親自嘗試抓取網站——而是閱讀
`directives/scrape_website.md`，確定輸入/輸出，然後運行 `execution/scrape_single_site.py`。
**第三層：執行（實際操作）**
- `execution/` 目錄下的確定性 Python 腳本
- 環境變數、API 令牌等儲存在 `.env` 檔案中
- 處理 API 呼叫、資料處理、檔案操作和資料庫交互
- 可靠、可測試、快速。使用腳本代替手動操作。註解清晰。
**為什麼這種方法有效：** 若您事事親力親為，錯誤會不斷累積。每一步 90% 的準確率，5 步下來
只有 59% 的成功率。解決方案是將複雜性轉移到確定性代碼中。這樣你就可以專注在決策了。
## 操作原則
**1. 先檢查工具**
在編寫腳本之前，請依照指令檢查 `execution/` 目錄。只有在不存在的情況下才建立新腳本。
**2. 出現問題時自我修復**
- 閱讀錯誤訊息和堆疊跟踪
- 修復腳本並再次測試（除非腳本使用了付費代幣/積分等——在這種情況下，請先與用戶確認）
- 根據你所了解的資訊更新指令（API 限制、時間限制、特殊情況）
- 例如：你遇到了 API 速率限制 → 然後你查看 API → 找到一個可以解決問題的批次端點 → 重寫
腳本以適應 → 測試 → 更新指令。
**3. 隨著學習不斷更新指令**
指令是動態文檔。當你發現 API 限制、更好的方法、常見錯誤或時間限制時，請更新指令。但除非
明確指示，否則不要在未經詢問的情況下創建或覆蓋指令。指令集是你的指令，必須妥善保存（並
隨著時間的推移不斷改進，而不是臨時使用後就棄之不用）。
## 自退火循環
錯誤是學習的機會。當出現問題時：
1. 修復問題
2. 更新工具
3. 測試工具，確保其正常運作
4. 更新指令以包含新的流程
5. 系統現在更強大了
## 文件組織
**最終成果與中間文件：**
- **最終成果**：使用者可以存取的 Google Sheets、Google Slides 或其他雲端輸出文件
- **中間文件**：處理過程中所需的臨時文件
**目錄結構：**
- `.tmp/` - 所有中間檔案（檔案、抓取的資料、暫存匯出檔案）。切勿提交，始終重新產生。
- `execution/` - Python 腳本（確定性工具）
- `directives/` - Markdown 格式的標準作業程序 (SOP)（指令集）
- `.env` - 環境變數與 API 金鑰
- `credentials.json`、`token.json` - Google OAuth 憑證（必需文件，已新增至 `.gitignore` 文件中）
**關鍵原則：** 本地文件僅用於處理。最終交付物儲存在雲端服務（Google Sheets、Slides 等）中
，使用者可以存取這些服務。 `.tmp/` 目錄中的所有內容都可以刪除並重新產生。
## 總結
您負責連結人類意圖（指令）和確定性執行（Python 腳本）。閱讀指令，做出決策，呼叫工具，處理
錯誤，並持續改進系統。
務實。可靠。自我修復